<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìš°ë¬´ì‚¬ë¦¬ ìœ„ì¹˜ ê¸°ë°˜ ê°ì • ì‹œì‘</title>
  <style>
    body {
      font-family: 'sans-serif';
      text-align: center;
      background-color: #fffaf2;
      padding: 2rem;
    }

    #status {
      margin: 2rem 0;
      font-size: 1.3rem;
    }

    #startBtn {
      display: none;
      font-size: 1.4rem;
      padding: 0.8rem 1.5rem;
      border: none;
      border-radius: 10px;
      background-color: #ffcab0;
      color: #333;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    #startBtn:hover {
      background-color: #ffb89c;
    }
  </style>
</head>
<body>
  <h1>ìš°ë¬´ì‚¬ë¦¬ê°€ ë‹¹ì‹ ì˜ ìœ„ì¹˜ë¥¼ í™•ì¸í•˜ê³  ìˆì–´ìš”</h1>
  <div id="status">â³ ìœ„ì¹˜ ì •ë³´ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
  <button id="startBtn">ë‚´ ê°ì • ì•Œì•„ë³´ê¸°</button>

  <script>
    const statusEl = document.getElementById("status");
    const startBtn = document.getElementById("startBtn");

    function checkGeolocationPermission() {
      if (!navigator.permissions || !navigator.geolocation) {
        statusEl.innerText = "âŒ ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì„œë¹„ìŠ¤ë¥¼ ì§€ì›í•˜ì§€ ì•Šì•„ìš”.";
        return;
      }

      navigator.permissions.query({ name: "geolocation" }).then(function(result) {
        if (result.state === "granted") {
          statusEl.innerText = "âœ… ìœ„ì¹˜ ì„œë¹„ìŠ¤ í—ˆìš©ë¨!";
          getLocation();
        } else if (result.state === "prompt") {
          statusEl.innerText = "â” ìœ„ì¹˜ ì„œë¹„ìŠ¤ ìš”ì²­ ì¤‘...";
          requestLocation();
        } else if (result.state === "denied") {
          statusEl.innerText = "ğŸš« ìœ„ì¹˜ ì„œë¹„ìŠ¤ê°€ ì°¨ë‹¨ë˜ì–´ ìˆì–´ìš”.";
        }

        result.onchange = () => checkGeolocationPermission();
      });
    }

    function requestLocation() {
      navigator.geolocation.getCurrentPosition(
        function (position) {
          const lat = position.coords.latitude.toFixed(5);
          const lon = position.coords.longitude.toFixed(5);
          statusEl.innerText = `ğŸ“ ìœ„ì¹˜ í™•ì¸ ì™„ë£Œ! ìœ„ë„: ${lat}, ê²½ë„: ${lon}`;
          startBtn.style.display = "inline-block";
        },
        function (error) {
          statusEl.innerText = "ìœ„ì¹˜ ì ‘ê·¼ì´ ê±°ë¶€ë˜ì—ˆì–´ìš”.";
        }
      );
    }

    function getLocation() {
      navigator.geolocation.getCurrentPosition(function (position) {
        const lat = position.coords.latitude.toFixed(5);
        const lon = position.coords.longitude.toFixed(5);
        statusEl.innerText = `ğŸ“ í˜„ì¬ ìœ„ì¹˜: ìœ„ë„ ${lat}, ê²½ë„ ${lon}`;
        startBtn.style.display = "inline-block";
      });
    }

    // ê°ì • ì§ˆë¬¸ìœ¼ë¡œ ì´ë™í•˜ëŠ” ë™ì‘
    startBtn.addEventListener("click", function () {
      alert("ì´ì œ ê°ì • ì„ íƒ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤! ğŸˆ");
      // ì—¬ê¸°ì— ì‹¤ì œ ê°ì • ì„ íƒ í˜ì´ì§€ ë§í¬ ì—°ê²° ê°€ëŠ¥
      // location.href = "emotion.html";
    });

    checkGeolocationPermission();
  </script>
</body>
</html>
